{"version":3,"sources":["utils.js","particle.js","index.js"],"names":["randomBetween","min","max","Math","random","clamp","value","raf","callback","fps","delay","time","frame","rafId","loop","timestamp","seg","floor","requestAnimationFrame","stop","cancelAnimationFrame","start","range","length","from","Array","_","i","Particle","options","el","document","createElement","classList","add","size","ttl","scatter","radius","style","width","height","x","y","startTime","Date","destroyed","angle","PI","position","sqrt","sin","y2","cos","x2","update","dt","tx","ty","opacity","round","transform","destroy","initPane","cb","pane","Tweakpane","title","expanded","addInput","step","label","on","paneEl","querySelector","stopPropagation","e","addEventListener","createParticles","particles","map","particle","create","node","spawn","container","appendChild","main","handleClick","clientX","clientY","forEach","handleMove","type","touches","body","removeEventListener","innerHTML","settings","window","innerWidth","innerHeight","getElementById"],"mappings":"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","file":"src.1d8b7c3f.js","sourceRoot":"../../src/sketches/particle-trail/src","sourcesContent":["/**\n * Get random value between in range\n * @param {number} [min] min value (default: 0)\n * @param {number} [max] max value (default: 1)\n */\nexport function randomBetween(min = 0, max = 1) {\n  return Math.random() * (max - min) + min;\n}\n\n/**\n * Limit value in range\n * @param {number} value input value\n * @param {number} [min] min value (default: 0)\n * @param {number} [max] max value (default: 1)\n */\nexport function clamp(value, min = 0, max = 1) {\n  return Math.max(Math.min(value, max), min);\n}\n\n/**\n * @param {Function} callback\n * @param {number} fps number of frames per second\n * @returns {Function} call to start/re-start\n */\nexport function raf(callback, fps = 60) {\n  const delay = 1000 / fps;\n  let time = null;\n  let frame = -1;\n  let rafId = null;\n\n  /** @param {number} timestamp */\n  function loop(timestamp) {\n    if (time === null) {\n      time = timestamp;\n    }\n\n    const seg = Math.floor((timestamp - time) / delay);\n\n    if (seg > frame) {\n      frame = seg;\n      callback(timestamp);\n    }\n\n    rafId = requestAnimationFrame(loop);\n  }\n\n  return {\n    stop() {\n      if (rafId != null) {\n        cancelAnimationFrame(rafId);\n        rafId = null;\n        time = null;\n        frame = -1;\n      }\n    },\n    start() {\n      loop(0);\n    },\n  };\n}\n\n/**\n * Get array of number\n * @param {number} length\n * @param {number} [from]\n */\nexport function range(length, from = 0) {\n  return Array.from({ length }, (_, i) => from + i);\n}\n","import { clamp } from './utils';\n\n/**\n * @typedef Options\n * @property {number} options.ttl\n * @property {number} options.size\n * @property {number} options.scatter\n * @property {number} options.radius\n */\n\nexport class Particle {\n  /** @param {Options} options */\n  static create(options) {\n    return new Particle(options);\n  }\n\n  /** @param {Options} options */\n  constructor(options) {\n    const el = document.createElement('div');\n    el.classList.add('particle');\n\n    this.el = el;\n    this.size = options.size;\n    this.ttl = options.ttl;\n    this.scatter = options.scatter / 2;\n    this.radius = options.radius;\n\n    this.el.style.width = `${options.size}px`;\n    this.el.style.height = `${options.size}px`;\n  }\n\n  /**\n   * @param {Object} params\n   * @param {number} param.x\n   * @param {number} param.y\n   * @returns {HTMLElement}\n   */\n  spawn({ x, y }) {\n    this.startTime = new Date();\n    this.destroyed = false;\n\n    const angle = 2 * Math.PI * Math.random();\n    const radius = this.scatter * this.scatter * Math.random();\n\n    this.position = {\n      y: y - Math.sqrt(radius) * Math.sin(angle),\n      y2: y + Math.sin(angle) * this.radius,\n      x: x - Math.sqrt(radius) * Math.cos(angle),\n      x2: x + Math.cos(angle) * this.radius,\n    };\n\n    this.update();\n\n    return this.el;\n  }\n\n  update() {\n    if (this.destroyed) {\n      return;\n    }\n\n    const dt = new Date() - this.startTime;\n    const tx = this.position.x + (this.position.x - this.position.x2) * (dt / this.ttl);\n    const ty = this.position.y + (this.position.y - this.position.y2) * (dt / this.ttl);\n\n    const opacity = clamp(1 - dt / this.ttl, 0, 1);\n    const size = clamp(Math.round(this.size - this.size * (dt / this.ttl)), 0, this.size);\n\n    this.el.style.opacity = opacity;\n    this.el.style.transform = `translate(${tx}px, ${ty}px) scale(${size / this.size})`;\n\n    if (size === 0) {\n      this.destroy();\n    }\n  }\n\n  destroy() {\n    this.destroyed = true;\n  }\n}\n","import { raf, randomBetween, range } from './utils';\nimport { Particle } from './particle';\n\nfunction initPane(options, cb) {\n  // eslint-disable-next-line no-undef\n  const pane = new Tweakpane({ title: 'Parameters', expanded: false });\n\n  pane.addInput(options, 'particles', { min: 1, max: 1000, step: 1 });\n  pane.addInput(options, 'scatter', { min: 1, step: 1 });\n  pane.addInput(options, 'radius', { min: 1, step: 1 });\n  pane.addInput(options, 'size', { min: 1, step: 1 });\n  pane.addInput(options.ttl, 'min', {\n    label: 'TTL (min)',\n    min: 1,\n    max: 5000,\n    step: 1,\n  });\n  pane.addInput(options.ttl, 'max', {\n    label: 'TTL (max)',\n    min: 10,\n    max: 5000,\n    step: 1,\n  });\n\n  pane.on('change', () => cb());\n\n  const paneEl = document.querySelector('.tp-dfwv');\n  const stopPropagation = (e) => e.stopPropagation();\n\n  paneEl.addEventListener('click', stopPropagation);\n  paneEl.addEventListener('mousemove', stopPropagation);\n  paneEl.addEventListener('touchmove', stopPropagation);\n}\n\nfunction createParticles(options) {\n  return range(options.particles).map(() => {\n    const particle = Particle.create({\n      size: options.size,\n      ttl: randomBetween(options.ttl.min, options.ttl.max),\n      scatter: options.scatter,\n      radius: options.radius,\n    });\n\n    const node = particle.spawn({ x: options.width / 2, y: options.height / 2 });\n\n    options.container.appendChild(node);\n\n    return particle;\n  });\n}\n\nfunction main(options) {\n  const particles = createParticles(options);\n\n  let x = options.width / 2;\n  let x2 = options.width / 2;\n  let y = options.height / 2;\n  let y2 = options.height / 2;\n\n  const handleClick = ({ clientX, clientY }) => {\n    x2 = clientX;\n    y2 = clientY;\n\n    particles.forEach((particle) => {\n      particle.destroy();\n      particle.spawn({ x: x2, y: y2 });\n    });\n  };\n\n  const handleMove = (e) => {\n    if (e.type === 'touchmove') {\n      x2 = e.touches[0].clientX;\n      y2 = e.touches[0].clientY;\n    } else {\n      x2 = e.clientX;\n      y2 = e.clientY;\n    }\n  };\n\n  document.body.addEventListener('click', handleClick);\n  document.body.addEventListener('mousemove', handleMove);\n  document.body.addEventListener('touchmove', handleMove);\n\n  const { start, stop } = raf(() => {\n    x -= (x - x2) * 0.2;\n    y -= (y - y2) * 0.2;\n\n    particles.forEach((particle) => {\n      if (particle.destroyed) {\n        particle.spawn({ x, y });\n      }\n\n      particle.update();\n    });\n  });\n\n  start();\n\n  return () => {\n    document.body.removeEventListener('click', handleClick);\n    document.body.removeEventListener('mousemove', handleMove);\n    document.body.removeEventListener('touchmove', handleMove);\n\n    particles.forEach((particle) => {\n      particle.destroy();\n      // eslint-disable-next-line no-param-reassign\n      options.container.innerHTML = '';\n    });\n\n    stop();\n  };\n}\n\n/* ********************************************************************* */\n\nconst settings = {\n  width: window.innerWidth,\n  height: window.innerHeight,\n  container: document.getElementById('canvas'),\n  particles: 100,\n  scatter: 30,\n  radius: 30,\n  size: 5,\n  ttl: {\n    min: 500,\n    max: 2500,\n  },\n};\n\nlet stop = main(settings);\ninitPane(settings, () => {\n  stop();\n  stop = main(settings);\n});\n"]}