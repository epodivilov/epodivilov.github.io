{"version":3,"sources":["utils.js","index.js"],"names":["raf","callback","fps","delay","time","frame","_id","loop","timestamp","seg","Math","floor","requestAnimationFrame","cancelAnimationFrame","prefersColorScheme","window","matchMedia","matches","settings","canvas","document","getElementById","theme","localStorage","getItem","hue","saturation","lightness","circles","points","offset","speed","rays","initPane","options","pane","Tweakpane","title","expanded","addInput","Dark","Light","on","value","body","classList","add","remove","setItem","addSeparator","min","max","step","pathFabric","context","baseRadius","color","amplitude","beginPath","i","alpha","PI","radius","sin","x","cos","y","moveTo","lineTo","closePath","fillStyle","fill","initCanvas","width","height","getContext","translate","size","draw","fillRect"],"mappings":"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","file":"src.0713e5e8.js","sourceRoot":"../../src/sketches/mandala/src","sourcesContent":["/**\n * @param {Function} callback\n * @param {number} fps\n * @returns {Function} call to start/re-start\n */\nexport function raf(callback, fps = 60) {\n  let delay = 1000 / fps;\n  let time = null;\n  let frame = -1;\n  let _id = null;\n\n  /** @param {number} timestamp */\n  function loop(timestamp) {\n    if (time === null) {\n      time = timestamp;\n    }\n\n    const seg = Math.floor((timestamp - time) / delay);\n\n    if (seg > frame) {\n      frame = seg;\n      callback(timestamp);\n    }\n\n    _id = requestAnimationFrame(loop);\n  }\n\n  return () => {\n    if (_id != null) {\n      cancelAnimationFrame(_id);\n      _id = null;\n      time = null;\n      frame = -1;\n    }\n\n    loop(0);\n  };\n}\n","import { raf } from './utils';\n\nconst prefersColorScheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\nconst settings = {\n  canvas: document.getElementById('canvas'),\n  theme: localStorage.getItem('theme') || prefersColorScheme,\n  hue: 25,\n  saturation: 60,\n  lightness: 50,\n  circles: 32,\n  points: 500,\n  offset: 2,\n  speed: 1,\n  rays: 6,\n};\n\ndocument.body.classList.add(settings.theme);\n\nfunction initPane(options) {\n  const pane = new Tweakpane({ title: 'Parameters', expanded: false });\n  pane.addInput(options, 'theme', { options: { Dark: 'dark', Light: 'light' } }).on('change', (value) => {\n    if (value === 'dark') {\n      document.body.classList.add('dark');\n      document.body.classList.remove('light');\n      localStorage.setItem('theme', 'dark');\n    } else {\n      document.body.classList.add('light');\n      document.body.classList.remove('dark');\n      localStorage.setItem('theme', 'light');\n    }\n  });\n  pane.addSeparator();\n  pane.addInput(options, 'hue', { min: 0, max: 360, step: 1 });\n  pane.addInput(options, 'saturation', { min: 0, max: 100, step: 1 });\n  pane.addInput(options, 'lightness', { min: 0, max: 100, step: 1 });\n  pane.addSeparator();\n  pane.addInput(options, 'circles', { min: 1, step: 1 });\n  pane.addInput(options, 'points', { min: 3, step: 1 });\n  pane.addSeparator();\n  pane.addInput(options, 'offset', { min: 1, step: 1 });\n  pane.addInput(options, 'speed', { min: 0, step: 1 });\n  pane.addInput(options, 'rays', { min: 1, step: 1 });\n}\n\n/**\n * @param {CanvasRenderingContext2D} context\n * @param {Object} options\n */\nfunction pathFabric(context, options) {\n  /**\n   * @param {number} baseRadius\n   * @param {string} color\n   * @param {number} amplitude\n   * @param {number} offset\n   */\n  return function draw(baseRadius, color, amplitude, offset) {\n    const points = options.points;\n\n    context.beginPath();\n    for (let i = 0; i <= points; i++) {\n      const alpha = (i * Math.PI * 2) / points;\n      const radius = baseRadius + amplitude * Math.sin(alpha * options.rays + offset);\n      const x = radius * Math.cos(alpha);\n      const y = radius * Math.sin(alpha);\n\n      if (i === 0) {\n        context.moveTo(x, y);\n      } else {\n        context.lineTo(x, y);\n      }\n    }\n    context.closePath();\n\n    context.fillStyle = color;\n    context.fill();\n  };\n}\n\n/**\n * @param {Object} options\n * @param {HTMLCanvasElement} options.canvas\n * @param {'dark' | 'light'} options.theme\n * @param {number} options.hue\n * @param {number} options.saturation\n * @param {number} options.lightness\n * @param {number} options.circles\n * @param {number} options.points\n * @param {number} options.offset\n * @param {number} options.speed\n */\nfunction initCanvas(options) {\n  const size = 1000;\n  options.canvas.width = size;\n  options.canvas.height = size;\n\n  /** @type {CanvasRenderingContext2D} */\n  const context = options.canvas.getContext('2d');\n  context.translate(size / 2, size / 2);\n\n  const draw = pathFabric(context, options);\n\n  let hue = 0;\n  raf((timestamp) => {\n    const { saturation, lightness, offset, speed, circles, theme } = options;\n\n    const { width, height } = context.canvas;\n\n    context.fillStyle = theme === 'dark' ? '#152028' : '#E9FCFF';\n    context.fillRect(-width / 2, -height / 2, width, height);\n\n    // hue += 0.7;\n\n    for (let i = 0; i < circles; i++) {\n      const radius = width * 0.3 - i * 10;\n      const color = `hsl(${hue + i * options.hue}, ${saturation}%, ${lightness}%)`;\n      const step = (i * Math.PI) / offset + 3 * (timestamp / (2000 / speed));\n      const amplitude = width * 0.05 + 1.5 * (circles - i); /* * Math.sin(timestamp / (1000 / speed)) */\n\n      draw(radius, color, amplitude, step);\n    }\n  }, 24)();\n}\n\ninitPane(settings);\ninitCanvas(settings);\n"]}